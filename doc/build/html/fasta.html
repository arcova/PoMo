

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>libPomo.fasta &mdash; PoMo 1.0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PoMo 1.0.2 documentation" href="index.html" />
    <link rel="next" title="libPomo.vcf" href="vcf.html" />
    <link rel="prev" title="libPomo.seqbase" href="seqbase.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vcf.html" title="libPomo.vcf"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="seqbase.html" title="libPomo.seqbase"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">PoMo 1.0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-libPoMo.fasta"></span><div class="section" id="libpomo-fasta">
<h1>libPomo.fasta<a class="headerlink" href="#libpomo-fasta" title="Permalink to this headline">¶</a></h1>
<p>This module provides functions to read, write and access fasta files.</p>
<p>Classes:
- <cite>FaStream</cite>, fasta file sequence stream object
- <cite>FaSeq</cite>, fasta file sequence object</p>
<p>Exception Classes:
- <cite>NotAFastaFileError</cite></p>
<p>Functions:
- <cite>read_seq_from_fo()</cite>: Read a single fasta sequence.
- <cite>init_seq()</cite>: Initialize fasta sequence stream from file.
- <cite>open_seq()</cite>: Open fasta file.
- <cite>save_as_vcf()</cite>: Save a given <cite>FaSeq</cite> in variant call format (VCF).</p>
<dl class="class">
<dt id="libPoMo.fasta.FaSeq">
<em class="property">class </em><tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">FaSeq</tt><a class="reference internal" href="_modules/libPoMo/fasta.html#FaSeq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaSeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Store sequence data retrieved from a fasta file.</p>
<dl class="method">
<dt id="libPoMo.fasta.FaSeq.get_seq_base">
<tt class="descname">get_seq_base</tt><big>(</big><em>seq</em>, <em>pos</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaSeq.get_seq_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaSeq.get_seq_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Return base at position <cite>pos</cite> in sequence with name <cite>seq</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="libPoMo.fasta.FaSeq.get_seq_by_id">
<tt class="descname">get_seq_by_id</tt><big>(</big><em>i</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaSeq.get_seq_by_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaSeq.get_seq_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sequence number <cite>i</cite> as <cite>Seq</cite> object.</p>
</dd></dl>

<dl class="method">
<dt id="libPoMo.fasta.FaSeq.get_seq_names">
<tt class="descname">get_seq_names</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaSeq.get_seq_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaSeq.get_seq_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with sequence names.</p>
</dd></dl>

<dl class="method">
<dt id="libPoMo.fasta.FaSeq.print_info">
<tt class="descname">print_info</tt><big>(</big><em>maxB=50</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaSeq.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaSeq.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print sequence information.</p>
<p>Print fasta sequence identifier, species names, the length of
the sequence and a maximum of <cite>maxB</cite> bases (defaults to 50).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="libPoMo.fasta.FaStream">
<em class="property">class </em><tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">FaStream</tt><big>(</big><em>name</em>, <em>firstSeq</em>, <em>nextHL</em>, <em>faFileObject</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaStream" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that stores a fasta file sequence stream.</p>
<p>The sequence of one species/individual/chromosome is saved and
functions are provided to read in the next sequence in the file,
if there is any. This saves memory if files are huge and doesn&#8217;t
increase runtime.</p>
<dl class="method">
<dt id="libPoMo.fasta.FaStream.close_fo">
<tt class="descname">close_fo</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaStream.close_fo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaStream.close_fo" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the linked file.</p>
</dd></dl>

<dl class="method">
<dt id="libPoMo.fasta.FaStream.print_info">
<tt class="descname">print_info</tt><big>(</big><em>maxB=50</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaStream.print_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaStream.print_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print sequence information.</p>
<p>Print information about this FaStream object, the fasta
sequence stored at the moment the length of the sequence and a
maximum of <cite>maxB</cite> bases (defaults to 50).</p>
</dd></dl>

<dl class="method">
<dt id="libPoMo.fasta.FaStream.read_next_seq">
<tt class="descname">read_next_seq</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#FaStream.read_next_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.FaStream.read_next_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Read next fasta sequence in file.</p>
<p>The return value is the name of the next sequence or None if
no next sequence is found.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="libPoMo.fasta.NotAFastaFileError">
<em class="property">exception </em><tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">NotAFastaFileError</tt><a class="reference internal" href="_modules/libPoMo/fasta.html#NotAFastaFileError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.NotAFastaFileError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised if given fasta file is not valid.</p>
</dd></dl>

<dl class="function">
<dt id="libPoMo.fasta.init_seq">
<tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">init_seq</tt><big>(</big><em>faFileName</em>, <em>maxskip=50</em>, <em>name=None</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#init_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.init_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a fasta file and initialize an FaStream.</p>
<p>This function tries to open the given fasta file, checks if it is
in fasta format and reads the first sequence.  It returns an
<cite>FaStream</cite> object. This object can later be used to parse the
whole fasta file.</p>
<p>Please close the associated file object with
yourFaStream.close_fo() when you don&#8217;t need it anymore.</p>
<ul class="simple">
<li><cite>maxskip</cite>: Only look <cite>maxskip</cite> lines for the start of a sequence</li>
</ul>
<p>(defaults to 50).</p>
<ul class="simple">
<li><cite>name</cite>: Set the name of the sequence to <cite>name</cite>, otherwise set it</li>
</ul>
<p>to the stripped filename.</p>
</dd></dl>

<dl class="function">
<dt id="libPoMo.fasta.open_seq">
<tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">open_seq</tt><big>(</big><em>faFileName</em>, <em>maxskip=50</em>, <em>name=None</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#open_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.open_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Open and read a fasta file.</p>
<p>This function tries to open the given fasta file, checks if it is
in fasta format and reads the sequence(s).  It returns an <cite>FaSeq</cite>
object that contains a list of species names, a list of the
respective desriptions and a list with the sequences.</p>
<ul class="simple">
<li><cite>maxskip</cite>: Only look <cite>maxskip</cite> lines for the start of a sequence</li>
</ul>
<p>(defaults to 50).</p>
<ul class="simple">
<li><cite>name</cite>: Set the name of the sequence to <cite>name</cite>, otherwise set it</li>
</ul>
<p>to the stripped filename.</p>
</dd></dl>

<dl class="function">
<dt id="libPoMo.fasta.read_seq_from_fo">
<tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">read_seq_from_fo</tt><big>(</big><em>line</em>, <em>fo</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#read_seq_from_fo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.read_seq_from_fo" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single fasta sequence.</p>
<p>Read a single fasta sequence from file object <cite>fo</cite> and save it to
a new <cite>Seq</cite> sequence object. Returns the header line of the next
fasta sequence and the newly created sequence. If no new sequence
is found, the next header line will be set to None.</p>
<ul class="simple">
<li><cite>line</cite>: the header line of the sequence.</li>
<li><cite>fo</cite>: the file object of the fasta file.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="libPoMo.fasta.save_as_vcf">
<tt class="descclassname">libPoMo.fasta.</tt><tt class="descname">save_as_vcf</tt><big>(</big><em>faSeq</em>, <em>ref</em>, <em>VCFFileName</em><big>)</big><a class="reference internal" href="_modules/libPoMo/fasta.html#save_as_vcf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#libPoMo.fasta.save_as_vcf" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the given <cite>FaSeq</cite> in VCF format.</p>
<p>In general, we want to convert a fasta file with various
individuals with the help of a reference that contains one
sequence to a VCF file that contains all the SNPs.  This can be
done with this function.  Until now it is not possible to do this
conversion for several chromosomes for each individual in one run.
Still, the conversion can be done chromosome by chromosome.</p>
<p>This function saves the SNPs of <cite>faSeq</cite>, a given <cite>FaSeq</cite> (fasta
sequence) object in VCF format to the file <cite>VCFFileName</cite>.  The
reference genome <cite>ref</cite>, to which <cite>faSeq</cite> is compared to, needs to
be passed as a <cite>Seq</cite> object.</p>
<p>The function compares all sequences in <cite>faSeq</cite> to the sequence
given in <cite>ref</cite>.  The names of the individuals in the saved VCF
file will be the sequence names of the <cite>faSeq</cite> object.</p>
<p>#CHROM = sequence name of the reference
POS    = position relative to reference
ID     = .
REF    = base of reference
ALT    = SNP (e.g. &#8216;C&#8217; or &#8216;G,T&#8217; if 2 different SNPs are present)
QUAL   = .
FILTER = .
INFO   = .
FORMAT = GT</p>
<ul class="simple">
<li><cite>faSeq</cite>: <cite>FaSeq</cite> object to be converted.</li>
<li><cite>ref</cite>: <cite>Seq</cite> object of the reference sequence.</li>
<li><cite>VCFFileName</cite>: Name of the VCF output file.</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="seqbase.html"
                        title="previous chapter">libPomo.seqbase</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="vcf.html"
                        title="next chapter">libPomo.vcf</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/fasta.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="vcf.html" title="libPomo.vcf"
             >next</a> |</li>
        <li class="right" >
          <a href="seqbase.html" title="libPomo.seqbase"
             >previous</a> |</li>
        <li><a href="index.html">PoMo 1.0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Dominik Schrempf.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>